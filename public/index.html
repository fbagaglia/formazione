<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accademia dell'Umanesimo Digitale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --nero: #0C0D0D;
            --verde: #379557;
            --bianco: #D9E1DA;
        }
        body { background-color: var(--nero); color: var(--bianco); font-family: 'Inter', sans-serif; }
        .card-bg { background-color: rgba(217, 225, 218, 0.05); transition: all 0.3s ease; }
        .card-bg:hover { border-color: var(--verde); transform: translateY(-4px); }
    </style>
</head>
<body class="min-h-screen">
    <header class="border-b border-white/10 sticky top-0 bg-black/80 backdrop-blur-xl z-50">
        <div class="max-w-6xl mx-auto px-6 py-5">
            <div class="cursor-pointer" onclick="window.location.href='index.html'">
                <h1 class="text-xl font-bold tracking-tight">Accademia Umanesimo Digitale</h1>
                <p class="text-[10px] uppercase tracking-widest text-emerald-500 font-bold">Franco Bagaglia • Longlife Learning</p>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-6 py-16">
        <div id="loader" class="flex flex-col items-center py-20">
            <div class="w-10 h-10 border-4 border-emerald-500/20 border-t-emerald-500 rounded-full animate-spin"></div>
            <p class="mt-4 text-xs opacity-50 tracking-widest uppercase">Sincronizzazione Sapere...</p>
        </div>

        <section id="catalog-view" class="hidden">
            <h2 class="text-5xl font-black mb-12">I Sentieri del <span class="text-emerald-500">Futuro</span>.</h2>
            <div id="catalog-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </section>
    </main>

    <script>
        const API = '/api/classroom';
        
        // Funzione per navigare in modo sicuro
        function navigateToCourse(id) {
            if (!id) return;
            window.location.href = `course.html?id=${id}`;
        }

        async function loadCatalog() {
            try {
                const res = await fetch(`${API}/courses`);
                // Fallback a un array vuoto se la chiamata fallisce
                const courses = res.ok ? await res.json() : [];
                
                const grid = document.getElementById('catalog-grid');
                if (courses.length === 0) {
                    grid.innerHTML = '<p class="opacity-50">Nessun corso disponibile al momento.</p>';
                } else {
                    grid.innerHTML = courses.map(c => `
                        <div class="card-bg p-10 rounded-[32px] border border-white/10 cursor-pointer flex flex-col h-full" 
                             onclick="navigateToCourse('${c.id}')">
                            <h3 class="text-2xl font-bold mb-4">${c.title}</h3>
                            <p class="text-sm opacity-60 mb-8 flex-grow">${c.subtitle || 'Esplora le frontiere dell\'etica digitale.'}</p>
                            <div class="text-emerald-500 font-black text-xs tracking-widest uppercase">Visualizza Dettagli →</div>
                        </div>
                    `).join('');
                }
                
                document.getElementById('loader').classList.add('hidden');
                document.getElementById('catalog-view').classList.remove('hidden');
            } catch (e) {
                console.error("Errore catalogo:", e);
                document.getElementById('loader').innerHTML = '<p class="text-red-500">Errore di connessione al server.</p>';
            }
        }

        window.onload = loadCatalog;
    </script>
</body>
</html>
